Interrupt Control State Register 0xE000ED04
Pin 28 is for pendsv. 

skip Some of the steps?

the handler
PendSV_Handler
    CPSID   I                  ; Prevent interruption during context switch
    PUSH    {R4-R11}           ; Save remaining regs r4-11 
    LDR     R0, =RunPt         ; R0=pointer to RunPt, old thread
    LDR     R1, [R0]		   ; RunPt->stackPointer = SP;
    STR     SP, [R1]           ; save SP of process being switched out

    LDR     R1, =NextThreadPt  ; R1=pointer to NextThreadPt, next thread to run
    LDR     R2, [R1]		   ; R2=value of NextThreadPt
    STR     R2, [R0]           ; RunPt = NextThreadPt;

    LDR     SP, [R2]           ; new thread SP; SP = RunPt->stackPointer;
    POP     {R4-R11}           ; restore regs r4-11 

    CPSIE   I				   ; tasks run with I=0
    BX      LR                 ; Exception return will restore remaining context 